/*
* uxTransPerf v.0.1.0
* (c) 2014, WebUX
* License: MIT.
*/
!function(a){function b(){function a(a,b,c,d){var f=0;if(!x.length)throw new Error("benchmark must be executed first.");if(d)if("string"==typeof d)d===x[0].name&&(f+=1);else for(;-1!==d.indexOf(x[f].name);)f+=1;return e[x[f].index].run(a,b,c)}function b(a,b,c,d){return!d&&x.length?(a(x,1),b(),void 0):(t=document.createElement("p"),document.body.insertBefore(t,null),w=c||1e4,u=a,v=b,x=!d&&m()||[],s=t.offsetTop,x.length?(u(x,1),v(),void 0):(t.style.position="absolute",t.style.top="0px",t.style.left="0px",g(),void 0))}function f(a){a.style[c[d]]="",a.style.left="0px",a.style.top="0px",a.style.marginLeft="0px",a.style.marginTop="0px"}function g(){return e[B]?(h(e[B]),void 0):(B=0,D=setTimeout(i),void 0)}function h(a){var b,c="undefined";a.run(t.style,1,1),typeof t.getBoundingClientRect!==c&&(b=t.getBoundingClientRect(),a.supported=!!b.top),a.supported?B+=1:(e.splice(B,1),y.log("%s is not supported",a.id)),f(t),setTimeout(g)}function i(){var a=e.length;e[B].supported?(r={id:e[B].id,name:e[B].name,index:B,iterations:0},j(r,t,e[B],z,r.iterations),r.end=Date.now(),x[B]=r,B+=1,C=B/a,u(x,C),a>B?(clearTimeout(D),D=setTimeout(i)):(o(x),document.getElementsByTagName("body")[0].className+=" "+x[0].id,v(),m()||n(x),document.body.removeChild(t),t=null,u=null,v=null)):y.log("%s NOT SUPPORTED",e[B].id)}function j(a,b,c,d,e){var g,h=0,i=0,j=0;if(d){for(a.timeLimit=d,g=Date.now()+d;Date.now()<g;)i=j+=1,c.run(b.style,i,j),h+=1;a.iterations=h}else{for(a.start=Date.now();e>h;)i=j+=1,c.run(b.style,i,j),h+=1;a.end=Date.now(),a.iterations=e}return f(b),a}function k(){for(var a,b,c,d=0,f=x.length,g=[];f>d;)a=x[d],b={},c=e[a.index],a.supported?c.run(b,"%x","%y"):b="NOT SUPPORTED",g.push({name:a.name,time:a.total,count:a.iterations,pattern:b}),d+=1;return g}function l(){try{return window.hasOwnProperty("localStorage")&&null!==window.localStorage}catch(a){return y.log(a.Description),!1}}function m(){if(!l())return void 0;var a,b=localStorage.getItem(A),c=b&&JSON.parse(b)||void 0;return c&&(a=y.expire-(Date.now()-c.expire),a>0)?(y.log("stored value found. %ss left till expire. Delete transPerf local storage to clear now.",Math.round(a/1e3)),c.value):void 0}function n(a){if(!l())return void 0;try{localStorage.setItem(A,JSON.stringify({expire:Date.now(),value:a}))}catch(b){return!1}return!0}function o(a){for(var b,c=0,d=a.length;d>c;)b=a[c],b.total=b.timeLimit?b.iterations:b.end-b.start,c+=1;return q(a,function(a,b){return a.timeLimit?b.total-a.total:a.total-b.total}),a}function p(a){for(var b,c="",d=0,e=a.length;e>d;)b=a[d],c+=b.name+": "+(b.timeLimit?"count = "+b.total+" in "+b.timeLimit+"ms\n":"time = "+b.total+"ms\n"),d+=1;return c}function q(a,b){var c,d=0,e=a.length,f=0,g=a.length-1;for(b||(b=function(a,b){return a>b?1:b>a?-1:0});e>d;){for(f=0,g=a.length-1;g>f;)b(a[f],a[f+1])>0&&(c=a[f+1],a[f+1]=a[f],a[f]=c),f+=1;d+=1}return a}var r,s,t,u,v,w,x=[],y={},z=20,A="ux-transform-perf",B=0,C=0,D=0;return y.best=a,y.benchmark=b,y.getResults=k,y.log=function(){},y.getLog=function(){return p(x)},y}var c={"":"transform",webkit:"webkitTransform",Moz:"MozTransform",O:"OTransform",ms:"msTransform"},d=function(){var a,b,c=["t","webkitT","MozT","msT","OT"],d=c.length,e=document.createElement("div").style;for(b=0;d>b;b+=1)if(a=c[b]+"ransform",a in e)return c[b].substr(0,c[b].length-1);return!1}(),e=[{id:"trans",name:"translate",supported:!1,run:function(a,b,e){a[c[d]]="translate("+b+"px, "+e+"px)"}},{id:"transXY",name:"translate X/Y",supported:!1,run:function(a,b,e){a[c[d]]="translateX("+b+"px) translateY("+e+"px)"}},{id:"transXYZ",name:"translate X/Y/Z",supported:!1,run:function(a,b,e){a[c[d]]="translateX("+b+"px) translateY("+e+"px) translateZ(0)"}},{id:"transXYZ1",name:"translate x/y/z with z not zero",supported:!1,run:function(a,b,e){a[c[d]]="translateX("+b+"px) translateY("+e+"px) translateZ(0.1px)"}},{id:"transTransZ",name:"translate, translateZ",supported:!1,run:function(a,b,e){a[c[d]]="translate("+b+"px, "+e+"px) translateZ(0)"}},{id:"posLT",name:"position left/top",supported:!1,run:function(a,b,c){a.left=b+"px",a.top=c+"px"}},{id:"trans3d",name:"translate3d",supported:!1,run:function(a,b,e){a[c[d]]="translate3d("+b+"px, "+e+"px, 0px)"}},{id:"trans3dZ1",name:"translate3d with Z not zero",supported:!1,run:function(a,b,e){a[c[d]]="translate3d("+b+"px, "+e+"px, 0.1px)"}}];a.transPerf=b();try{angular.module("ux")}catch(f){angular.module("ux",[])}ux.transPerf.events={UPDATED:"transPerf:update",COMPLETED:"transPerf:complete"},angular.module("ux").directive("uxTransPerf",["$rootScope",function(a){return{restrict:"A",template:"<div></div><div>{{percent}}</div>",scope:{},link:function(b,c,d){ux.transPerf.expire=ux.transPerf.expire||parseInt(d.expire||0,10)||6e4,setTimeout(function(){ux.transPerf.benchmark(function(b,c){a.$broadcast(ux.transPerf.events.UPDATED,c)},function(){ux.transPerf.best(c.children()[0].style,100,100),a.$broadcast(ux.transPerf.events.COMPLETED),b.$destroy(),c.remove(),a.$apply()},d.uxTransPerf||1e4)})}}}])}(this.ux=this.ux||{},function(){return this}());